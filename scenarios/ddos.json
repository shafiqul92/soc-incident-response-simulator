{
  "name": "DDoS Attack Scenario",
  "type": "DDoS",
  "description": "This comprehensive DDoS scenario covers multiple attack types and response strategies. You'll practice detecting initial traffic spikes, identifying SYN flood patterns, and responding to morphing attacks that combine multiple techniques. Each sub-scenario focuses on a different aspect of DDoS defense, teaching you to recognize attack patterns, implement appropriate containment measures, and coordinate with upstream providers when needed. Perfect for learning the complete DDoS incident response lifecycle.",
  "events": [
    { "id": "event_1", "type": "alert", "timestamp": "2025-11-15T10:00:00Z", "source": "Network Monitor", "severity": "medium", "title": "Unusual Traffic Spike Detected", "description": "Inbound TCP connection rate increased by 300% in the last 5 minutes", "metrics": { "inbound_connections": 15000, "normal_baseline": 5000, "cpu_usage": 45, "memory_usage": 52 } },
    { "id": "event_2", "type": "log", "timestamp": "2025-11-15T10:00:30Z", "source": "Firewall", "severity": "medium", "title": "Connection Rate Limit Approaching", "description": "Firewall connection rate limit (20,000/min) at 76%. Many connections from same IP ranges.", "log_entry": "2025-11-15 10:00:30 [INFO] Firewall: 15,234/min (76%). Top source: 203.0.113.0/24", "metrics": { "inbound_connections": 15234, "firewall_utilization": 76, "cpu_usage": 48 } },
    { "id": "event_3", "type": "alert", "timestamp": "2025-11-15T10:01:00Z", "source": "Load Balancer", "severity": "medium", "title": "Backend Server Health Degrading", "description": "One backend shows increased latency. Health check response time increased to 450ms.", "metrics": { "backend_latency_ms": 450, "healthy_servers": 2, "total_servers": 3, "cpu_usage": 52 } },
    { "id": "event_4", "type": "log", "timestamp": "2025-11-15T10:01:30Z", "source": "Web Server", "severity": "medium", "title": "Thread Pool Busy", "description": "Web worker threads are saturating under load.", "log_entry": "2025-11-15 10:01:30 [WARN] Worker threads busy: 85%", "metrics": { "cpu_usage": 62, "memory_usage": 60 } },
    { "id": "event_5", "type": "log", "timestamp": "2025-11-15T10:02:00Z", "source": "Web Server", "severity": "high", "title": "High CPU Usage Alert", "description": "Server CPU usage reached 85%. Response times increasing.", "log_entry": "2025-11-15 10:02:00 [WARNING] CPU usage: 85%, Load avg: 12.3", "metrics": { "cpu_usage": 85, "memory_usage": 68, "response_time_ms": 2500 } },
    { "id": "decision_1", "type": "decision_point", "timestamp": "2025-11-15T10:02:15Z", "description": "You've detected a significant traffic spike with increasing CPU usage. What is your immediate response?", "max_score": 10, "options": [
      { "id": "opt_1", "text": "Block top 10 source IPs immediately", "action_type": "block_ip", "target": "203.0.113.10", "correct": true, "score": 10, "feedback": "Correct! Quick containment reduces attack volume.", "explanation": "Blocking the heaviest sources immediately reduces impact." },
      { "id": "opt_2", "text": "Restart the web server", "action_type": "restart_service", "correct": false, "score": 2, "feedback": "Not ideal. Does not stop the attack.", "explanation": "Restarting causes downtime and the flood resumes." },
      { "id": "opt_3", "text": "Wait and monitor for 10 more minutes", "action_type": "monitor", "correct": false, "score": 0, "feedback": "Incorrect. Immediate action is required.", "explanation": "Delaying allows further impact and service degradation." },
      { "id": "opt_4", "text": "Engage upstream provider for traffic scrubbing", "action_type": "escalate", "correct": true, "score": 8, "feedback": "Good choice, especially for large floods.", "explanation": "Upstream filtering removes malicious traffic earlier in the network path." }
    ]},
    { "id": "event_6", "type": "alert", "timestamp": "2025-11-15T10:02:30Z", "source": "Network Monitor", "severity": "high", "title": "SYN Flood Pattern Detected", "description": "65% of incoming connections are incomplete SYN requests.", "log_entry": "2025-11-15 10:02:30 [ALERT] 9,750 incomplete SYN from 203.0.113.0/24", "metrics": { "incomplete_syn_connections": 9750, "syn_flood_percentage": 65, "inbound_connections": 18000, "cpu_usage": 78 } },
    { "id": "event_7", "type": "log", "timestamp": "2025-11-15T10:03:00Z", "source": "Application Server", "severity": "high", "title": "Connection Pool Exhausted", "description": "DB connection pool at capacity; new requests queuing.", "log_entry": "2025-11-15 10:03:00 [ERROR] DB Pool: 100/100. Queue depth: 45", "metrics": { "db_connections": 100, "db_queue_depth": 45, "memory_usage": 72, "cpu_usage": 82 } },
    { "id": "event_8", "type": "log", "timestamp": "2025-11-15T10:03:30Z", "source": "APM", "severity": "high", "title": "Timeouts Increasing", "description": "15% of requests timing out.", "log_entry": "2025-11-15 10:03:30 [ERROR] Timeouts: 15%", "metrics": { "failed_requests": 1200, "response_time_ms": 6000, "cpu_usage": 88 } },
    { "id": "event_9", "type": "log", "timestamp": "2025-11-15T10:04:00Z", "source": "Network Monitor", "severity": "critical", "title": "Service Degradation", "description": "Response time exceeded 5s. Connection timeouts reported.", "log_entry": "2025-11-15 10:04:00 [CRITICAL] Service unavailable 18%", "metrics": { "cpu_usage": 95, "memory_usage": 82, "response_time_ms": 8500, "failed_requests": 1500 } },
    { "id": "event_10", "type": "alert", "timestamp": "2025-11-15T10:04:30Z", "source": "Network Monitor", "severity": "high", "title": "Traffic Pattern Analysis", "description": "80% of traffic is SYN flood from 203.0.113.0/24", "metrics": { "inbound_connections": 12000, "syn_flood_percentage": 80, "cpu_usage": 78 } },
    { "id": "decision_2", "type": "decision_point", "timestamp": "2025-11-15T10:04:45Z", "description": "You've identified a SYN flood attack causing service degradation. What additional containment measure should you take?", "max_score": 10, "options": [
      { "id": "opt_5", "text": "Enable SYN cookies on the firewall", "action_type": "configure_firewall", "correct": true, "score": 10, "feedback": "Excellent! Reduces resource exhaustion.", "explanation": "SYN cookies avoid holding half-open connections in memory." },
      { "id": "opt_6", "text": "Increase server memory allocation", "action_type": "scale_resources", "correct": false, "score": 3, "feedback": "Delays, doesn't solve.", "explanation": "Scaling without mitigation is temporary and costly." },
      { "id": "opt_7", "text": "Block entire 203.0.113.0/24 subnet", "action_type": "block_ip", "target": "203.0.113.0/24", "correct": true, "score": 8, "feedback": "Effective containment.", "explanation": "Subnet blocking reduces malicious flow substantially." },
      { "id": "opt_8", "text": "Disable TCP connections temporarily", "action_type": "configure_firewall", "correct": false, "score": 1, "feedback": "Too disruptive.", "explanation": "This would break all legitimate traffic." }
    ]},
    { "id": "event_11", "type": "alert", "timestamp": "2025-11-15T10:07:00Z", "source": "Network Monitor", "severity": "medium", "title": "UDP Amplification Suspected", "description": "Small portion of traffic appears to be UDP amplification.", "metrics": { "udp_amplification_pct": 10, "inbound_connections": 8000 } },
    { "id": "event_12", "type": "log", "timestamp": "2025-11-15T10:07:30Z", "source": "Firewall", "severity": "medium", "title": "Rate Limiting Applied", "description": "Applied rate limits to suspicious subnets.", "log_entry": "2025-11-15 10:07:30 [INFO] Rate limit applied to 203.0.113.0/24", "metrics": { "inbound_connections": 7000, "cpu_usage": 60 } },
    { "id": "event_13", "type": "log", "timestamp": "2025-11-15T10:08:30Z", "source": "SIEM", "severity": "medium", "title": "New IP Range Involved", "description": "Another range 198.51.100.0/24 contributing to flood.", "log_entry": "2025-11-15 10:08:30 [ALERT] New range 198.51.100.0/24", "metrics": { "inbound_connections": 7500 } },
    { "id": "event_14", "type": "alert", "timestamp": "2025-11-15T10:09:00Z", "source": "Network Monitor", "severity": "high", "title": "Attack Morphing", "description": "Shift from SYN to mixed SYN/UDP patterns.", "metrics": { "syn_flood_percentage": 55, "udp_amplification_pct": 20 } },
    { "id": "event_15", "type": "log", "timestamp": "2025-11-15T10:09:15Z", "source": "Network Monitor", "severity": "high", "title": "UDP Traffic Increasing", "description": "UDP amplification now 35% of total traffic.", "log_entry": "2025-11-15 10:09:15 [ALERT] UDP: 35% of traffic", "metrics": { "udp_amplification_pct": 35, "inbound_connections": 9000, "cpu_usage": 75 } },
    { "id": "decision_3", "type": "decision_point", "timestamp": "2025-11-15T10:09:30Z", "description": "Attack is morphing from SYN to mixed SYN/UDP patterns. What is your next action?", "max_score": 10, "options": [
      { "id": "opt_9", "text": "Request upstream to enable scrubbing for both TCP and UDP", "action_type": "escalate", "correct": true, "score": 10, "feedback": "Best step for mixed floods.", "explanation": "Upstream scrubbing handles volumetric blends effectively." },
      { "id": "opt_10", "text": "Disable UDP globally on firewall", "action_type": "configure_firewall", "correct": false, "score": 4, "feedback": "May break legitimate traffic.", "explanation": "Too disruptive for general operations." },
      { "id": "opt_11", "text": "Do nothing and continue monitoring", "action_type": "monitor", "correct": false, "score": 0, "feedback": "Incorrect. The attack is changing.", "explanation": "Requires proactive containment." },
      { "id": "opt_12", "text": "Block only UDP traffic", "action_type": "block_ip", "correct": false, "score": 5, "feedback": "Partial solution.", "explanation": "Doesn't address the SYN portion of the attack." }
    ]}
  ]
}
