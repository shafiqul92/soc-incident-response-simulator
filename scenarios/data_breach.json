{
  "name": "Data Breach Scenario",
  "type": "Data Breach",
  "description": "This data breach scenario walks you through the complete attack lifecycle: from initial credential stuffing attempts, through successful account compromise, to active data exfiltration. You'll learn to detect brute force attacks, identify compromised accounts through geolocation anomalies, and respond to active data theft. Each sub-scenario builds on the previous one, teaching you to recognize different stages of a data breach and take appropriate containment actions at each phase.",
  "events": [
    { "id": "event_1", "type": "alert", "timestamp": "2025-11-15T14:00:00Z", "source": "Authentication", "severity": "medium", "title": "Multiple Failed Login Attempts", "description": "User 'jdoe' has 15 failed attempts from 198.51.100.45", "log_entry": "2025-11-15 14:00:00 [AUTH] Failed login: jdoe from 198.51.100.45 (15/5)", "metrics": { "failed_logins": 15, "source_ip": "198.51.100.45", "account": "jdoe" } },
    { "id": "event_2", "type": "log", "timestamp": "2025-11-15T14:01:00Z", "source": "Authentication", "severity": "medium", "title": "Credential Stuffing Pattern", "description": "Dozens of usernames with same IP.", "log_entry": "2025-11-15 14:01:00 [AUTH] Multiple accounts targeted from 198.51.100.45", "metrics": { "accounts_targeted": 24 } },
    { "id": "event_3", "type": "alert", "timestamp": "2025-11-15T14:02:00Z", "source": "WAF", "severity": "medium", "title": "Login Page Flood", "description": "High POST rate to /login", "metrics": { "login_posts_per_min": 800 } },
    { "id": "event_4", "type": "log", "timestamp": "2025-11-15T14:02:30Z", "source": "Authentication", "severity": "high", "title": "Account Lockout Triggered", "description": "Account 'jdoe' locked after 20 failed attempts.", "log_entry": "2025-11-15 14:02:30 [AUTH] Account locked: jdoe", "metrics": { "account_locked": true, "failed_attempts": 20 } },
    { "id": "event_5", "type": "alert", "timestamp": "2025-11-15T14:03:00Z", "source": "SIEM", "severity": "high", "title": "Brute Force Attack Detected", "description": "Coordinated attack on 50+ accounts from same IP range.", "log_entry": "2025-11-15 14:03:00 [SIEM] Brute force: 50 accounts, 198.51.100.0/24", "metrics": { "accounts_targeted": 50, "source_range": "198.51.100.0/24" } },
    { "id": "decision_1", "type": "decision_point", "timestamp": "2025-11-15T14:03:15Z", "description": "You've detected a coordinated credential stuffing attack targeting multiple accounts. What is your immediate response?", "max_score": 10, "options": [
      { "id": "opt_1", "text": "Block the entire IP range 198.51.100.0/24", "action_type": "block_ip", "target": "198.51.100.0/24", "correct": true, "score": 10, "feedback": "Correct! Blocks the attack source effectively.", "explanation": "Blocking the source IP range stops the credential stuffing attack." },
      { "id": "opt_2", "text": "Enable rate limiting on login endpoint", "action_type": "configure_firewall", "correct": true, "score": 8, "feedback": "Good defensive measure.", "explanation": "Rate limiting reduces attack effectiveness but doesn't stop it completely." },
      { "id": "opt_3", "text": "Wait to see if any accounts are compromised", "action_type": "monitor", "correct": false, "score": 0, "feedback": "Incorrect. Immediate action is required.", "explanation": "Delaying allows the attack to continue and potentially succeed." },
      { "id": "opt_4", "text": "Disable all targeted accounts", "action_type": "disable_account", "correct": false, "score": 3, "feedback": "Too disruptive for legitimate users.", "explanation": "This would lock out legitimate users unnecessarily." }
    ]},
    { "id": "event_6", "type": "log", "timestamp": "2025-11-15T14:03:00Z", "source": "Authentication", "severity": "high", "title": "Successful Login from Unusual Location", "description": "User 'jdoe' logged in from UA; normal is US.", "log_entry": "2025-11-15 14:03:00 [AUTH] Success: jdoe from 198.51.100.45 (UA)", "metrics": { "login_success": true, "geolocation_anomaly": true, "previous_country": "US", "current_country": "UA" } },
    { "id": "event_7", "type": "log", "timestamp": "2025-11-15T14:04:00Z", "source": "VPN", "severity": "medium", "title": "Impossible Travel", "description": "jdoe observed from UA then US within 10 minutes.", "metrics": { "impossible_travel": true } },
    { "id": "event_8", "type": "alert", "timestamp": "2025-11-15T14:04:30Z", "source": "SIEM", "severity": "high", "title": "Geolocation Anomaly Score", "description": "High risk score: 95/100 for jdoe session.", "log_entry": "2025-11-15 14:04:30 [SIEM] Geo anomaly: jdoe (95/100)", "metrics": { "anomaly_score": 95 } },
    { "id": "event_9", "type": "log", "timestamp": "2025-11-15T14:05:00Z", "source": "Authentication", "severity": "medium", "title": "New Device Registration", "description": "Unknown device 'Windows 10' registered from UA location.", "log_entry": "2025-11-15 14:05:00 [AUTH] New device: Windows 10 from UA", "metrics": { "new_device": true, "device_type": "Windows 10" } },
    { "id": "event_10", "type": "alert", "timestamp": "2025-11-15T14:05:30Z", "source": "Access Control", "severity": "high", "title": "Accessing Sensitive Resources", "description": "jdoe accessing customer database from unusual location.", "log_entry": "2025-11-15 14:05:30 [ACCESS] jdoe -> customer_db from UA", "metrics": { "sensitive_access": true, "resource": "customer_db" } },
    { "id": "decision_2", "type": "decision_point", "timestamp": "2025-11-15T14:05:45Z", "description": "You've detected a successful login from an unusual location with impossible travel patterns. What is your response?", "max_score": 10, "options": [
      { "id": "opt_5", "text": "Immediately disable the account and force password reset", "action_type": "disable_account", "target": "jdoe", "correct": true, "score": 10, "feedback": "Correct! Stops potential credential misuse.", "explanation": "Account disablement prevents further unauthorized access." },
      { "id": "opt_6", "text": "Require MFA verification for this session", "action_type": "configure_firewall", "correct": true, "score": 7, "feedback": "Good additional security measure.", "explanation": "MFA adds a layer but doesn't stop an already-compromised session." },
      { "id": "opt_7", "text": "Monitor the session for suspicious activity", "action_type": "monitor", "correct": false, "score": 2, "feedback": "Too passive for high-risk indicators.", "explanation": "Monitoring alone doesn't prevent potential data exfiltration." },
      { "id": "opt_8", "text": "Block the IP address only", "action_type": "block_ip", "target": "198.51.100.45", "correct": false, "score": 5, "feedback": "Partial solution.", "explanation": "Attacker may have already established session or can use different IPs." }
    ]},
    { "id": "event_11", "type": "alert", "timestamp": "2025-11-15T14:05:00Z", "source": "Network Monitor", "severity": "high", "title": "Unusual Outbound Data Transfer", "description": "2.3 GB transferred from db-server-01 to 198.51.100.45", "log_entry": "2025-11-15 14:05:00 [NET] 2.3GB outbound to 198.51.100.45 from db-server-01:5432", "metrics": { "data_transferred_gb": 2.3, "destination_ip": "198.51.100.45", "source_host": "db-server-01", "port": 5432 } },
    { "id": "event_12", "type": "log", "timestamp": "2025-11-15T14:05:30Z", "source": "DLP", "severity": "high", "title": "Sensitive Keywords Detected", "description": "Customer SSN pattern in outbound stream.", "metrics": { "dlp_hits": 120 } },
    { "id": "event_13", "type": "alert", "timestamp": "2025-11-15T14:06:00Z", "source": "Database Audit", "severity": "high", "title": "Bulk Export Command", "description": "jdoe executed COPY on customer_data.", "log_entry": "2025-11-15 14:06:00 [DB] COPY customer_data TO '/tmp/cust.csv'", "metrics": { "records_accessed": 150000 } },
    { "id": "event_14", "type": "log", "timestamp": "2025-11-15T14:06:30Z", "source": "Endpoint", "severity": "medium", "title": "Suspicious Process", "description": "powershell.exe spawned curl to external IP.", "metrics": { "process": "powershell.exe", "child": "curl.exe" } },
    { "id": "event_15", "type": "alert", "timestamp": "2025-11-15T14:07:00Z", "source": "Proxy", "severity": "high", "title": "Large HTTPS Upload", "description": "700 MB uploaded to external IP 198.51.100.45", "log_entry": "2025-11-15 14:07:00 [PROXY] 700MB HTTPS upload to 198.51.100.45", "metrics": { "https_upload_mb": 700, "destination_ip": "198.51.100.45" } },
    { "id": "decision_3", "type": "decision_point", "timestamp": "2025-11-15T14:07:15Z", "description": "You've detected active data exfiltration with sensitive data patterns. What is your immediate containment action?", "max_score": 10, "options": [
      { "id": "opt_9", "text": "Isolate db-server-01 from the network immediately", "action_type": "isolate_host", "target": "db-server-01", "correct": true, "score": 10, "feedback": "Excellent! Stops exfiltration immediately.", "explanation": "Host isolation cuts outbound data flow quickly." },
      { "id": "opt_10", "text": "Disable the compromised account (jdoe)", "action_type": "disable_account", "target": "jdoe", "correct": true, "score": 8, "feedback": "Good containment measure.", "explanation": "Stops further misuse but may not stop ongoing transfers." },
      { "id": "opt_11", "text": "Block the destination IP address", "action_type": "block_ip", "target": "198.51.100.45", "correct": false, "score": 4, "feedback": "Too late - data may already be transferred.", "explanation": "IP blocking helps but doesn't stop data already in transit." },
      { "id": "opt_12", "text": "Monitor to gather more evidence", "action_type": "monitor", "correct": false, "score": 0, "feedback": "Incorrect during active exfiltration.", "explanation": "Immediate containment is required to stop data loss." }
    ]}
  ]
}
